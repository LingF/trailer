extends ./layouts/default

block title
  title Koa Douban 首页

block content
  include ./includes/header

  .container-fluid
    .row
      nav.col-md-2.d-none.d-md-block.bg-light.sidebar
        .sidebar-sticky
          ul.nav.flex-column
            .nav-item
              a.nav-link(href='#')
                span.sr-only
      .col-md-10.pt-3
        .row
          .col-md-4
            .card
              img.card-img-top(src='http://o9spjqu1b.bkt.clouddn.com/5570778b-f7fc-4bcf-9df3-e47a6954b75a' data-video='http://video.iblack7.com/tgGnZRn3W4Ajw6PGcA_9Z.mp4')
              .card-body
                h4.card-title 这是电影标题
                p.card-desc 这是电影描述
              .card-footer
                small.text-muted 1天前更新
          .col-md-4
            .card
              img.card-img-top(src='http://o9spjqu1b.bkt.clouddn.com/5570778b-f7fc-4bcf-9df3-e47a6954b75a' data-video='http://video.iblack7.com/tgGnZRn3W4Ajw6PGcA_9Z.mp4')
              .card-body
                h4.card-title 这是电影标题
                p.card-desc 这是电影描述
              .card-footer
                small.text-muted 1天前更新  
          .col-md-4
            .card
              img.card-img-top(src='http://o9spjqu1b.bkt.clouddn.com/5570778b-f7fc-4bcf-9df3-e47a6954b75a' data-video='http://video.iblack7.com/tgGnZRn3W4Ajw6PGcA_9Z.mp4')
              .card-body
                h4.card-title 这是电影标题
                p.card-desc 这是电影描述
              .card-footer
                small.text-muted 1天前更新
        .row  
          .col-md-4
            .card
              img.card-img-top(src='http://o9spjqu1b.bkt.clouddn.com/5570778b-f7fc-4bcf-9df3-e47a6954b75a' data-video='http://video.iblack7.com/tgGnZRn3W4Ajw6PGcA_9Z.mp4')
              .card-body
                h4.card-title 这是电影标题
                p.card-desc 这是电影描述
              .card-footer
                small.text-muted 1天前更新
          .col-md-4
            .card
              img.card-img-top(src='http://o9spjqu1b.bkt.clouddn.com/5570778b-f7fc-4bcf-9df3-e47a6954b75a' data-video='http://video.iblack7.com/tgGnZRn3W4Ajw6PGcA_9Z.mp4')
              .card-body
                h4.card-title 这是电影标题
                p.card-desc 这是电影描述
              .card-footer
                small.text-muted 1天前更新
          .col-md-4
            .card
              img.card-img-top(src='http://o9spjqu1b.bkt.clouddn.com/5570778b-f7fc-4bcf-9df3-e47a6954b75a' data-video='http://video.iblack7.com/tgGnZRn3W4Ajw6PGcA_9Z.mp4')
              .card-body
                h4.card-title 这是电影标题
                p.card-desc 这是电影描述
              .card-footer
                small.text-muted 1天前更新

  #myModal.modal.fade.bd-example-modal-lg(tabindex="-1", role="dialog", aria-labelledby="myLargeModalLabel", aria-hidden="true")
    .modal-dialog.modal-lg
      #videoModal.modal-content

  include ./includes/script

  script.
    var player = null

    $(document).ready(function() {
      $('#myModal').on('hidden.bs.modal', function() {
        if (player && player.pause) player.pause()
      })

      $('.card-img-top').click(function(e) {
        var video = $(this).data('video')
        var image = $(this).attr('src')
  
        $('#myModal').modal('show')

        if (!player) {
          console.log(video)
          console.log(image)
          player = new DPlayer({
            container: document.getElementById('videoModal'),
            screenshot: true,
            video: {
              url: video,
              pic: image,
              thumbnails: image
            }
          })
        } else {
          if (player.video.currentSrc != video) {
            player.switchVideo({
              url: video,
              pic: image,
              type: 'auto'
            })
          }
        }
      })
    })